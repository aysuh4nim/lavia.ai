<!DOCTYPE html>
<html lang="tr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Lavia ile Sohbet</title>
    <link rel="stylesheet" href="style.css" />
    <style>
      body { margin: 0; overflow: hidden; }
      canvas { display: block; }
    </style>

    <!-- Importmap - Three.js mod√ºl yollarƒ± -->
    <script type="importmap">
      {
        "imports": {
          "three": "https://cdn.jsdelivr.net/npm/three@0.160.1/build/three.module.js",
          "three/addons/": "https://cdn.jsdelivr.net/npm/three@0.160.1/examples/jsm/"
        }
      }
    </script>
  </head>

  <body>
    <div class="chat-container">
      <canvas id="laviaCanvas"></canvas>
      <div class="chat-bubble" id="chatBubble">Merhaba! Konu≈ümak i√ßin mikrofon simgesine bas.</div>
      <button id="micButton">üéôÔ∏è</button>
    </div>

    <script type="module">
      import * as THREE from 'three';
      import { GLTFLoader } from 'three/addons/loaders/GLTFLoader.js';

      const canvas = document.getElementById('laviaCanvas');
      const scene = new THREE.Scene();

      const camera = new THREE.PerspectiveCamera(
        45,
        window.innerWidth / window.innerHeight,
        0.1,
        1000
      );
      camera.position.set(0, 1.6, 3);

      const renderer = new THREE.WebGLRenderer({ canvas, antialias: true, alpha: true });
      renderer.setSize(window.innerWidth, window.innerHeight);
      renderer.setPixelRatio(window.devicePixelRatio);

      const light = new THREE.DirectionalLight(0xffffff, 1);
      light.position.set(0, 5, 5);
      scene.add(light);

      const ambient = new THREE.AmbientLight(0x404040, 2);
      scene.add(ambient);

      const loader = new GLTFLoader();
      loader.load(
        './lavia/laviaModel.glb',
        function (gltf) {
          console.log('‚úÖ Lavia modeli y√ºklendi:', gltf);

          // üíñ Yukarƒ± √ßƒ±karƒ±yoruz
          gltf.scene.position.y = 0.9;

          scene.add(gltf.scene);
        },
        function (xhr) {
          console.log(`Y√ºkleniyor: ${Math.round((xhr.loaded / xhr.total) * 100)}%`);
        },
        function (error) {
          console.error('‚ùå Lavia modeli y√ºklenemedi:', error);
        }
      );

      function animate() {
        requestAnimationFrame(animate);
        renderer.render(scene, camera);
      }
      animate();

      window.addEventListener('resize', () => {
        camera.aspect = window.innerWidth / window.innerHeight;
        camera.updateProjectionMatrix();
        renderer.setSize(window.innerWidth, window.innerHeight);
      });
    </script>
  </body>
</html>
